@page "/users/{UserId:guid}"

@inherits OwningComponentBase<ApplicationDbContext>

@using Microsoft.EntityFrameworkCore

@inject NavigationManager navigationManager


<h3>EditUser</h3>
<NavLink href="users">Back to users</NavLink>

@if (user == null)
{
    <p>Loading</p>
}
else
{
    <button class="btn btn-danger" @onclick="DeleteUser">Delete</button>
}

@code {

    [Parameter]
    public Guid UserId { get; set; }
    User user;

    protected override async Task OnParametersSetAsync()
    {
        await base.OnInitializedAsync();
        user = await Service.Users.SingleOrDefaultAsync(u => u.Id == UserId);
    }
    private async Task DeleteUser()
    {
        Service.Users.Remove(user);
        await Service.SaveChangesAsync();
        navigationManager.NavigateTo("users");
    }
}
